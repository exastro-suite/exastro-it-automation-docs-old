========================
マニュアルビルドについて
========================

前提
----------

| 以下がインストールされている事とします。
|  sphinx-build 5.3.0 以上

ビルドについて
------------
| 本マニュアルは以下の作成手順をとります。
|   ビルド元 (図左側) を所定のフォーマットで記述  --> ビルドして結果(図右側)を得る
|
| 図右側の赤枠箇所はビルドによって自動生成されます。
.. image:: ./build_flow/image1.png
   :width: 5.84375in
   :height: 1.09375in


ビルドの流れ
------------

| ビルド作業は以下のステップで実施します。
|   1\. 大章ごとにディレクトリを作成
|   2\. 大章一覧を記述したファイル (indes.rst) を作成
|   3\. 作成した大章用ディレクトリ内に中章の内容 (=「右 pane のボディ」部分 ) を記述した 「.rst ファイル」 を作成
|   4\. 作成した大章用ディレクトリ内に画像ファイル格納用ディレクトリを作成
|   5\. 中章一覧を記述したファイル (index.rst) を作成
|   6\. 「.rst ファイル」群をビルドしてhtml ファイル生成

| ※ .rst ファイルは .docx (Word) ファイルから生成することもできますが本マニュアルでは直接 .rst ファイルを作成する方法で流れを説明します。
| 
| ステップ 1～6 の各手順について、赤枠内ドキュメントを例に挙げて説明します。
.. image:: ./build_flow/image4.png
   :width: 5.1083in
   :height: 2.3537in

| \ **ディレクトリ名は青字**\ 、ファイル名は\ **黒字**\ で表記します。
|
大章ごとにディレクトリを作成
-------------------------------
| 
| ディレクトリ名は各大章名(英語版)から引用し、以下の通りのフォーマットとします。
| It Automation Base it_automation_base (すべて小文字、単語間は \_
|    でつなぎます。)
| 
|    ドキュメントルート(documentation/v2.0/ja)
|      ┗install (大章「インストール」用)
| 大章一覧を記述したindex.rstファイルを作成
--------------------------------------------

|   ドキュメントルート(documentation/v2.0/ja)
|     ┗大章用ディレクトリ
|     ┗index.rst (大章一覧) **★追加** (記述方法は後述します) 

中章の内容を記述した 「.rst ファイル」 を作成
------------------------------------------------

| 作成した大章用ディレクトリ内に中章の内容 (=「右 pane のボディ」部分 )を記述した 「.rst ファイル」 を作成します。
|
| ドキュメントルート(documentation/v2.0/ja)
|   ┗大章用ディレクトリ
|   　┗中章の内容を記述した.rst ファイル **★追加**   (記述方法は後述します) 
|   ┗index.rst

画像ファイル格納用ディレクトリを作成
----------------------------------------

| ドキュメントルート(documentation/v2.0/ja)
|   ┗大章用ディレクトリ
|   　┗中章の内容を記述した.rst ファイル
|   　┗画像ファイル格納用ディレクトリ (.rst ファイル名と同名にします。)  **★追加**
|   ┗index.rst

中章一覧を記述したファイルを作成
------------------------------------------------

| ドキュメントルート(documentation/v2.0/ja)
|   ┗大章用ディレクトリ
|   　┗中章の内容を記述した.rst ファイル 
|   　┗画像ファイル格納用ディレクトリ  
|   　┗index.rst (中章一覧) **★追加**
|   ┗index.rst
|
| ここまでが必要なディレクトリ、ファイルの配置です。

ビルド
---------

| document ディレクトリ配下に html ディレクトリを作成します。
|
| ドキュメントルート(documentation/v2.0/ja)
|   ┗html **★追加**
|   ┗大章用ディレクトリ

| 所定のディレクトリ、rst ファイルを配置したうえで、document
| ディレクトリにカレントをうつし、以下コマンドを入力すると、htmlディレクトリ配下に html が生成されます。
| 
| sphinx-build -b html ./ ./html
| 
| ここまでが実装の流れです。続いて各 .rst ファイルの内容について説明します。

index.rst の役割1
-----------------

| ビルド時、システムはドキュメントルート、大章ディレクトリの配下に置かれたindex.rst の内容を見て章と章を紐づけ、全体を構成します。
.. image:: ./build_flow/image2.png
   :width: 5.84375in
   :height: 1.09375in

index.rst の役割2
----------------------------

| ドキュメントの見出しはドキュメントルート直下の index.rst にて定義します。

+------------------+----+---------------+-----------------------------+
| |image6|         | *  | **記述す      | **記述内容(抜粋)**          |
|                  | *→ | るindex.rst** |                             |
|                  | ** |               |                             |
+==================+====+===============+=============================+
|                  |    | ルートドキ    | ==========================  |
|                  |    | ュメント直下  |                             |
|                  |    |               | Exastro OASE 1.7            |
|                  |    |               |                             |
|                  |    |               | ==========================  |
+------------------+----+---------------+-----------------------------+

index.rst 構文
--------------
+--------------------------+-------------------------------------------+
| **構成要素**             | **意味**                                  |
+==========================+===========================================+
| ==============           | ドキュメント全体の見出し                  |
|                          |                                           |
| Exastro OASE 1.7         |                                           |
|                          |                                           |
| ==============           |                                           |
+--------------------------+-------------------------------------------+
| .. toctree::             |                                           |
|                          |                                           |
| :maxdepth: 1             |                                           |
|                          |                                           |
| :numbered: 2             |                                           |
+--------------------------+-------------------------------------------+
| introduction/index       | 章 "はじめに"                             |
|                          | が格納されているディレクトリ名/index      |
+--------------------------+-------------------------------------------+
| installation/index       | 章 "インストール "                        |
|                          | が格納されているディレクトリ名/index      |
+--------------------------+-------------------------------------------+
| oase_components/index    | ….                                        |
|                          |                                           |
|                          | ….                                        |
+--------------------------+-------------------------------------------+

ドキュメント記述用 .rst ファイル 構文 
-------------------------------------

| getting_oase.rst 等、ドキュメントを記述する .rst ファイル内の構文は以下の通りです。
+----+-----------------------------+-----------------------------------+
| ** | **構文**                    | **ビルド結果**                    |
| 種 |                             |                                   |
| 類 |                             |                                   |
| ** |                             |                                   |
+====+=============================+===================================+
| 大 |                             | |image7|                          |
| 見 | | Item 1                    |                                   |
| 出 | | =====                     |                                   |
| 見 |                             |                                   |
| 出 |                             |                                   |
| し |                             |                                   |
+----+-----------------------------+-----------------------------------+
| 見 | \- LinuxはLinus             | - LinuxはLinus                    |
| 出 |                             |                                   |
| し |                             |                                   |
| 要 |                             |                                   |
| 素 |                             |                                   |
+----+-----------------------------+-----------------------------------+
| 強 | \**強調*\*                  | **強調**                          |
| 調 |                             |                                   |
+----+-----------------------------+-----------------------------------+
| 画 | | .. figure::               | フォルダ内に                      |
| 像 | | ./path/imagefile          | 格納された画像が差し込まれます。  |
| し | | 　:scale: xx%             |                                   |
| 差 | | 　:align: xxx             |                                   |
| 込 |                             |                                   |
| み |                             |                                   |
|    |                             |                                   |
+----+-----------------------------+-----------------------------------+
| 表 | |image12|                   | |image13|                         |
| 差 |                             |                                   |
| し |                             |                                   |
| 込 |                             |                                   |
| み |                             |                                   |
| そ |                             |                                   |
| の |                             |                                   |
| 1  |                             |                                   |
+----+-----------------------------+-----------------------------------+
| 表 | | .. csv-table:: 通信要件   | |image14|                         |
| 差 | | 　:header: FROM, TO, PRTL |                                   |
| し | | 　:widths: 20, 20, 30     |                                   |
| 込 | | 作業端末, Exastro OASE,   |                                   |
| み | | "http(s) [80,443/tcp]",   |                                   |
| そ | | Exastro OASE,RDB(MariaDB),|                                   |
| の | | "3306/tcp                 |                                   |
| 2  |                             |                                   | 
+----+-----------------------------+-----------------------------------+

.. csv-table:: .rst ファイル内構文2
   :header: 種類, 構文, ビルド結果
   :widths: 10, 30, 30

   ボタン,\:guilabel:` アクション`,:guilabel:` アクション`
   メモ, "| \.. note:: | 補足的な情報を示しています。
   | 　　　　 | Note に記載されている内容は読み飛ばしても困ることは無いでしょう。", |image14|
   メモ(Tip), "| \.. tip:: | 操作や作業におけるノウハウを示しています。
   | 　　　　 | Tip に記載されている内容を読み飛ばした場合ユーザに混乱が生じる可能性があります。", |image15|
   メモ(Warning), "| \.. warning:: | 操作上の注意点を示しています。
   | 　　　　 | Warning に記載された内容はユーザが把握しておくほうが適切な情報です。", |image16|
   メモ(Danger), "| \.. danger:: | 正常なサービスへ影響を与える可能性がある操作についての危険性を示しています。
   | 　　　　 | Danger に記載された内容を知らない場合、大きな問題を引き起こす可能性があります。", |image17|

.. |image14| image:: ./build_flow/image14.png
   :width: 5.68735in
   :height: 0.56253in
.. |image15| image:: ./build_flow/image15.png
   :width: 5.60102in
   :height: 0.52416in
.. |image16| image:: ./build_flow/image16.png
   :width: 5.27072in
   :height: 0.49804in
.. |image17| image:: ./build_flow/image17.png
   :width: 5.54284in
   :height: 0.53672in
