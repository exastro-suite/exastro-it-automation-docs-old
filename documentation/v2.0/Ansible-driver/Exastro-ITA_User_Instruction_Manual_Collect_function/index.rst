.. image:: ./media/image1.png
   :width: 3.35069in
   :height: 0.78542in

ITA_利用手順マニュアル

収集機能

*－*\ 第1.10版\ *－*

Copyright © NEC Corporation 2020. All rights reserved.

免責事項

本書の内容はすべて日本電気株式会社が所有する著作権に保護されています。

本書の内容の一部または全部を無断で転載および複写することは禁止されています。

本書の内容は将来予告なしに変更することがあります。

日本電気株式会社は、本書の技術的もしくは編集上の間違い、欠落について、一切責任を負いません。

日本電気株式会社は、本書の内容に関し、その正確性、有用性、確実性その他いかなる保証もいたしません。

商標

-  LinuxはLinus
      Torvalds氏の米国およびその他の国における登録商標または商標です。

-  Red Hatは、Red Hat,
      Inc.の米国およびその他の国における登録商標または商標です。

-  Apache、Apache Tomcat、Tomcatは、Apache Software
      Foundationの登録商標または商標です。

-  Ansibleは、Red Hat, Inc.の登録商標または商標です。

-  AnsibleTowerは、Red Hat, Inc.の登録商標または商標です。

その他、本書に記載のシステム名、会社名、製品名は、各社の登録商標もしくは商標です。

なお、® マーク、TMマークは本書に明記しておりません。

※本書では「Exastro IT Automation」を「ITA」として記載します。

目次
====

`目次 <#目次>`__ `2 <#目次>`__

`はじめに <#_Toc101979278>`__ `3 <#_Toc101979278>`__

`1 収集機能概要 <#収集機能概要>`__ `4 <#収集機能概要>`__

`1.1 収集機能について <#収集機能について>`__ `4 <#収集機能について>`__

`1.1.1 収集機能概要図 <#収集機能概要図>`__ `4 <#収集機能概要図>`__

`1.1.2 収集機能データ登録処理概要図 <#収集機能データ登録処理概要図>`__
`5 <#収集機能データ登録処理概要図>`__

`1.2
パラメータシートへの登録方法について <#パラメータシートへの登録方法について>`__
`6 <#パラメータシートへの登録方法について>`__

`1.2.3 収集機能の動作要件 <#収集機能の動作要件>`__
`6 <#収集機能の動作要件>`__

`2
収集機能でのディレクトリ、ファイル構造、変数取り扱い <#収集機能でのディレクトリファイル構造変数取り扱い>`__
`7 <#収集機能でのディレクトリファイル構造変数取り扱い>`__

`2.1
収集対象ディレクトリ、ファイル構造 <#収集対象ディレクトリファイル構造>`__
`7 <#収集対象ディレクトリファイル構造>`__

`2.1.1
収集対象のファイルフォーマット <#収集対象のファイルフォーマット>`__
`7 <#収集対象のファイルフォーマット>`__

`2.1.2 収集対象ディレクトリ構造 <#収集対象ディレクトリ構造>`__
`7 <#収集対象ディレクトリ構造>`__

`2.2 取り扱う変数と種類 <#取り扱う変数と種類>`__
`10 <#取り扱う変数と種類>`__

`3 収集機能 コンソールメニュー構成 <#_Toc101979290>`__
`11 <#_Toc101979290>`__

`3.1 メニュー/画面一覧 <#メニュー画面一覧>`__ `11 <#メニュー画面一覧>`__

`4 収集機能の利用手順 <#収集機能の利用手順>`__
`13 <#収集機能の利用手順>`__

`4.1 作業フロー <#_Toc101979293>`__ `13 <#_Toc101979293>`__

`4.1.1 収集機能作業フロー <#収集機能作業フロー>`__
`13 <#収集機能作業フロー>`__

`5 収集機能・操作方法説明 <#収集機能操作方法説明>`__
`15 <#収集機能操作方法説明>`__

`5.1 Ansible 共通コンソール <#ansible-共通コンソール>`__
`15 <#ansible-共通コンソール>`__

`5.1.1 収集インターフェース情報 <#収集インターフェース情報>`__
`15 <#収集インターフェース情報>`__

`5.1.2 収集項目値管理 <#収集項目値管理>`__ `17 <#収集項目値管理>`__

`5.2
Ansible-Legacy、Ansible-Pioneer、Ansible-LegacyRoleコンソール <#ansible-legacyansible-pioneeransible-legacyroleコンソール>`__
`20 <#ansible-legacyansible-pioneeransible-legacyroleコンソール>`__

`5.2.1 収集状況の確認 <#収集状況の確認>`__ `20 <#収集状況の確認>`__

`5.3 BackYardコンテンツ <#backyardコンテンツ>`__
`22 <#backyardコンテンツ>`__

`5.3.1
パラメータシートへの登録処理の概要 <#パラメータシートへの登録処理の概要>`__
`22 <#パラメータシートへの登録処理の概要>`__

`6 運用操作 <#運用操作>`__ `23 <#運用操作>`__

`6.1 メンテナンス <#メンテナンス>`__ `23 <#メンテナンス>`__

`6.2 メンテナンス方法について <#メンテナンス方法について>`__
`23 <#メンテナンス方法について>`__

`7 付録 <#_Toc101979306>`__ `25 <#_Toc101979306>`__

`7.1 参考資材 <#参考資材>`__ `25 <#参考資材>`__

`7.2 収集実行例 <#収集実行例>`__ `27 <#収集実行例>`__

`7.2.1
複数ファイルの同一メニューを対象とした場合 <#複数ファイルの同一メニューを対象とした場合>`__
`27 <#複数ファイルの同一メニューを対象とした場合>`__

`7.2.2
収集対象ファイルの値の取り扱い <#収集対象ファイルの値の取り扱い>`__
`28 <#収集対象ファイルの値の取り扱い>`__

`7.2.3
複数の同一ファイル名がアップロード対象ファイルの指定例 <#複数の同一ファイル名がアップロード対象ファイルの指定例>`__
`32 <#複数の同一ファイル名がアップロード対象ファイルの指定例>`__

`7.2.4
ファイル削除時の収集対象ファイル内の記載例 <#ファイル削除時の収集対象ファイル内の記載例>`__
`33 <#ファイル削除時の収集対象ファイル内の記載例>`__

はじめに
========

本書では、ITAの機能および操作方法について説明します。

収集機能概要
============

本章では収集機能について説明します。

収集機能について
----------------

   収集機能とは、ITAで実施した、作業実行結果（規定のフォーマットで出力されたソースファイル）を元に、パラメータシートへ値を自動で登録する機能です。

   本機能は、Ansible-Driverを対象としています。

   Ansibleの詳細情報については、「Ansibleの製品マニュアル」を参照してください。

   Ansible-Driverの詳細情報については、「利用手順マニュアル
   Ansible-driver」を参照してください。

   パラメータシートの詳細については、「利用手順マニュアル
   メニュー作成機能」を参照してください。

収集機能概要図
~~~~~~~~~~~~~~

   以下は、収集機能実行までの全体の概要図です。

収集機能データ登録処理概要図
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

   以下は、収集機能のデータ登録処理の概要図です。

|image1|\ |image2|\ |image3|\ |image4|\ |image5|

※収集機能のデータ型の取り扱い例については、「\ **7.2.2収集対象ファイルの値の取り扱い**\ 」をご参照ください。

パラメータシートへの登録方法について
------------------------------------

収集機能は、ITAのオプションとして機能し、ITAの標準RESTAPI機能を利用してパラメータシートへの登録処理を実施します。

   RESTAPI機能の詳細については、「利用手順マニュアル_RestAPI」を参照してください。

収集機能の動作要件
~~~~~~~~~~~~~~~~~~

ITAで以下の設定がされていること。

-  ITA　インストーラにて、「createparam」、「ansible_driver」が選択され、インストールされている

-  メニュー定義/作成にて、パラメータシート（ホスト/オペレーションあり）が作成されている

-  設定値項目管理にて、登録情報（ソースファイル）とパラメータシートの項目と紐づけ設定がされている

-  収集インターフェース情報のRESTアクセス情報を更新済み

-  収集対象機器（ホスト名）が、機器一覧に登録済み

作業実行後に、以下の状態である場合、パラメータシートへの登録を実施します。

-  作業実行の結果、正常に完了している

-  作業実行の出力結果として、規定の構造でディレクトリ、ファイルが配置されている

..

   ※パラメータシートへの登録元となるソースファイルを生成するIaC（Playbook、Role）については、各ユーザー様で準備する必要があります。

   | 参考： Ansible Playbook Collection（OS設定収集）
   | https://github.com/exastro-suite/playbook-collection-docs/blob/master/README.ja.md

収集機能でのディレクトリ、ファイル構造、変数取り扱い
====================================================

収集対象ディレクトリ、ファイル構造
----------------------------------

1. .. rubric:: 収集対象のファイルフォーマット
      :name: 収集対象のファイルフォーマット

   1. Yaml形式で出力されたファイル

2. .. rubric:: 収集対象ディレクトリ構造
      :name: 収集対象ディレクトリ構造

収集対象ディレクトリについて、収集対象ディレクトリパス（ソースファイルの出力先として）をIaC(Playbook,Role)内にて、で以下の変数として扱えます。

表 2-1　収集機能対象ディレクトリITA 独自変数

+------------------------+---------------------------------------+-----+
| **ITA独自変数**        | **変数指定内容**                      | *   |
|                        |                                       | *備 |
|                        |                                       | 考  |
|                        |                                       | **  |
+========================+=======================================+=====+
| \__parameter_dir_\_    | 作業結果デ                            |     |
|                        | ィレクトリ配下の「_parameters」のパス |     |
+------------------------+---------------------------------------+-----+
| \__                    | 作業結果ディレク                      |     |
| parameters_file_dir_\_ | トリ配下の「_parameters_file」のパス  |     |
+------------------------+---------------------------------------+-----+
| \__par                 | 作業デ                                |     |
| ameters_dir_for_epc_\_ | ィレクトリ配下の「_parameters」のパス |     |
+------------------------+---------------------------------------+-----+
| \__paramete            | 作業ディレク                          |     |
| rs_file_dir_for_epc_\_ | トリ配下の「_parameters_file」のパス  |     |
+------------------------+---------------------------------------+-----+

..

   収集対象のディレクトリ（_parameters）の上位ディレクトリのパスについて、「Ansible共通」-「インターフェース情報」の「データリレイストレージパス(Ansible)」、Ansible-Driverの実行モード、実施した作業Noに依存します。

表 2-2　収集機能対象ディレクトリ、ファイル階層

+----------------------------------+-----------------------------------+
| **階層構造**                     | **備考**                          |
+==================================+===================================+
| 【上位ディレクトリ】             | ※1                                |
|                                  | 収集対象ディレクトリ（名称固定）  |
| \|- \_parameters 　※1            |                                   |
|                                  | ※2ホスト名                        |
| \| \|- localhost 　※2            |                                   |
|                                  | （機器一覧                        |
| \| \|- SAMPLE.yml 　※3           | に登録されているものが収集対象）  |
|                                  |                                   |
| \|- \_parameters_file ※4         | ※3 収集対象ファイル               |
|                                  |                                   |
| \| \|- localhost 　※2            | ※4収集対象ディレクトリフ          |
|                                  | ァイルアップロード用（名称固定）  |
| 　　　　|- test.txt 　※5         |                                   |
|                                  | ※                                 |
|                                  | 5ファイルアップロード対象ファイル |
+----------------------------------+-----------------------------------+

..

   ※データリレイストレージパス(Ansible)以降の階層構造

ソースファイルを生成するPlaybookを作成する際、の出力先について、「表
2-1　収集機能対象ディレクトリITA
独自変数」を使用しない場合、以下の構造を認識してPlaybookを記述する必要があります。

表 2-3　 Ansible-Driverモード別上位ディレクトリパス

+--------+---------+----------------------------------------------+---+
| **モ   | **モー  | **階層構造**                                 | * |
| ード** | ド別**  |                                              | * |
|        |         |                                              | 備 |
|        | **識    |                                              | 考 |
|        | 別子**  |                                              | * |
|        |         |                                              | * |
+========+=========+==============================================+===+
| An     | leg     | /デー                                        |   |
| sible- | acy/ns/ | タリレイストレージパス(Ansible）/legacy/ns/  |   |
| Legacy |         |                                              |   |
+--------+---------+----------------------------------------------+---+
| Ans    | pion    | /                                            |   |
| ible-P | eer/ns/ | データリレイストレージパス(Ansible）/pioneer |   |
| ioneer |         | /ns/                                         |   |
+--------+---------+----------------------------------------------+---+
| Ansibl | leg     | /デー                                        |   |
| e-Lega | acy/rl/ | タリレイストレージパス(Ansible）/legacy/rl/  |   |
| cyRole |         |                                              |   |
+--------+---------+----------------------------------------------+---+

+-----------------------------------------------------------------------+
| e.g.)　収集対象ファイルのファイルパス、ディレクトリ構造               |
|                                                                       |
| 実行モード： Ansible-Legacy                                           |
|                                                                       |
| 作業No ： 1                                                           |
|                                                                       |
| 対象ホスト： localhost                                                |
|                                                                       |
| 作業実行ディレク                                                      |
| トリ；/データリレイストレージパス(Ansible）/legacy/ns/0000000001/in/  |
|                                                                       |
| 作業結果ディレク                                                      |
| トリ；/データリレイストレージパス(Ansible）/legacy/ns/0000000001/out/ |
|                                                                       |
| 収集対象ファイルパス、ディレクトリ構造：                              |
|                                                                       |
| /データリレイストレージパ                                             |
| ス(Ansible）/legacy/ns/0000000001/in/_parameters/localhost/SAMPLE.yml |
|                                                                       |
| /データリレイストレージパス(An                                        |
| sible）/legacy/ns/0000000001/in/_parameters/localhost/OS/RH_snmpd.yml |
|                                                                       |
| /データリレイストレージパス(                                          |
| Ansible）/legacy/ns/0000000001/in/_parameters_file/localhost/TEST.txt |
|                                                                       |
| もしくは、                                                            |
|                                                                       |
| /データリレイストレージパス                                           |
| (Ansible）/legacy/ns/0000000001/out/_parameters/localhost/SAMPLE.yml  |
|                                                                       |
| /データリレイストレージパス(Ans                                       |
| ible）/legacy/ns/0000000001/out/_parameters/localhost/OS/RH_snmpd.yml |
|                                                                       |
| /データリレイストレージパス(A                                         |
| nsible）/legacy/ns/0000000001/out/_parameters_file/localhost/TEST.txt |
+=======================================================================+
+-----------------------------------------------------------------------+

**
**

**
**

   ファイルアップロードのメニューを収集対象とする場合、ソースファイルの変数の値（ファイル名/ファイルパス）と該当するファイル、が_parameters_file配下に配置されている必要があります。

   収集項目値管理の設定は、「5.1.2収集項目値管理」参照してください。

   ファイルアップロードの最大ファイルサイズについて、サーバースペックに依存するため、詳細は、「利用手順マニュアル_RestAPI」を参照してください

\_parameters_file配下に配置されているアップロード対象ファイルの指定方法として、以下の記載方法があります。

表 2-4　 アップロード対象ファイルの指定方法

+------------+--------------------------------------------------+-----+
| **         | **YAMLファイルへの記載方法**                     | *   |
| 指定方式** |                                                  | *備 |
|            |                                                  | 考  |
|            |                                                  | **  |
+============+==================================================+=====+
| ファ       | VAR_FILE_NAME : <‘ファイル名>’                   |     |
| イル名指定 |                                                  |     |
+------------+--------------------------------------------------+-----+
| ファイ     | VAR_FILE_NAME :                                  |     |
| ルパス指定 | ‘/<上位ディレクトリ>/_parameters_file/           |     |
|            | localhost/<階層X>/<ファイル名>’                  |     |
| (完全一致) |                                                  |     |
+------------+--------------------------------------------------+-----+
| ファイ     | VAR_FILE_NAME : ‘/<階層X>/<ファイル名>’          |     |
| ルパス指定 |                                                  |     |
|            |                                                  |     |
| (後方一致) |                                                  |     |
+------------+--------------------------------------------------+-----+

..

   ※ファイル名指定時、該当するファイルが複数存在する場合、対象となるファイルは、ランダムとなります。

   ファイルパス指定(完全一致)時、該当するパスにあるファイルとなります。

   ファイルパス指定(後方一致)時、該当するファイルが複数ある場合、対象となるファイルは、ランダムとなります。

+-----------------------------------------------------------------------+
| e.g.)                                                                 |
| 通常変数の構造の変数の場合のディレクトリ構造とソースファイルの内容    |
|                                                                       |
| ■構造                                                                 |
|                                                                       |
| 【上位ディレクトリ】                                                  |
|                                                                       |
| \|- \_parameters                                                      |
|                                                                       |
| \| \|- localhost                                                      |
|                                                                       |
| \| \|- SAMPLE.yml ※ソースファイル                                     |
|                                                                       |
| \|- \_parameters_file                                                 |
|                                                                       |
| \| \|- localhost                                                      |
|                                                                       |
| \| \|- test.txt ※アップロード対象ファイル                             |
|                                                                       |
| \| \|- APP001                                                         |
|                                                                       |
| \|- config ※アップロード対象ファイル                                  |
|                                                                       |
| ■収集対象ファイル名：SAMPLE.yml                                       |
|                                                                       |
| ■ファイルの内容                                                       |
|                                                                       |
| VAR_upload_file: test.txt                                             |
|                                                                       |
| VAR_upload_fileX: config                                              |
|                                                                       |
| VAR_upload_fileY: ‘/<上位ディレクトリ>/_parameters_file /localhost    |
| /APP001/config’                                                       |
|                                                                       |
| VAR_upload_fileZ: ‘/APP001/config’                                    |
+=======================================================================+
+-----------------------------------------------------------------------+

取り扱う変数と種類
------------------

   収集機能で扱うソースファイル内で扱える変数は以下の3種類があります。

表2.1変数の種類

+-----------+-------------------------------------+--------------------+
| 種類      | 内容                                | 備考               |
+===========+=====================================+====================+
| 通常変数  | 変数名に対                          |                    |
|           | して具体値を1つ定義できる変数です。 |                    |
|           |                                     |                    |
|           | +--------------------------------+  |                    |
|           | | e.g.)                          |  |                    |
|           | |                                |  |                    |
|           | | VAR_users: root                |  |                    |
|           | +================================+  |                    |
|           | +--------------------------------+  |                    |
+-----------+-------------------------------------+--------------------+
| 複数具    | 変数名に対し                        |                    |
| 体値変数  | て具体値を複数定義できる変数です。  |                    |
|           |                                     |                    |
|           | +--------------------------------+  |                    |
|           | | e.g.)                          |  |                    |
|           | |                                |  |                    |
|           | | VAR_users:                     |  |                    |
|           | |                                |  |                    |
|           | | - root                         |  |                    |
|           | |                                |  |                    |
|           | | - mysql                        |  |                    |
|           | +================================+  |                    |
|           | +--------------------------------+  |                    |
+-----------+-------------------------------------+--------------------+
| 多段変数  | 階層化された変数です。              |                    |
|           |                                     |                    |
|           | +--------------------------------+  |                    |
|           | | e.g.)                          |  |                    |
|           | |                                |  |                    |
|           | | VAR_users:                     |  |                    |
|           | |                                |  |                    |
|           | | - user-name: alice             |  |                    |
|           | |                                |  |                    |
|           | | authorized: password           |  |                    |
|           | |                                |  |                    |
|           | | メンバー変数名                 |  |                    |
|           | | は、下記の7文字を除くascii文字 |  |                    |
|           | |                                |  |                    |
|           | | | (0x20～0x7e)が使用出来ます。 |  |                    |
|           | | | 　" . [ ] ' \\ :             |  |                    |
|           | |                                |  |                    |
|           | | 尚、コーテーションで囲         |  |                    |
|           | | まないと変数名の先頭に使用出来 |  |                    |
|           | |                                |  |                    |
|           | | ない文字がいくつかあります。   |  |                    |
|           | | 詳しくは、Ansibleドキュメント  |  |                    |
|           | | Yaml sntaxを参照くだ\ `Yaml    |  |                    |
|           | | syntax <https://docs.a         |  |                    |
|           | | nsible.com/ansible/latest/refe |  |                    |
|           | | rence_appendices/YAMLSyntax.ht |  |                    |
|           | | ml#gotchas>`__\ を参照下さい。 |  |                    |
|           | +================================+  |                    |
|           | +--------------------------------+  |                    |
+-----------+-------------------------------------+--------------------+

収集機能 コンソールメニュー構成
===============================

本章では、ITAコンソールのメニュー構成について説明します

メニュー/画面一覧
-----------------

#. **Ansible共通コンソールのメニュー**

..

   Ansible共通コンソールのメニュー一覧を以下に記述します。

表 3-1共通コンソール メニュー/画面一覧

+---+-----------+----------------+-------------------------------------+
| N | メニュー  | メニュー・画面 | 説明                                |
| o | グループ  |                |                                     |
+===+===========+================+=====================================+
| 1 | An        | 収集インタ     | パラメータシートへの                |
|   | sible共通 | ーフェース情報 | データの登録時に使用する、ITA標準R  |
|   |           |                | EST機能にアクセスするサーバへの接続 |
|   | コ        |                | インターフェース情報を管理します。  |
|   | ンソール  |                |                                     |
+---+-----------+----------------+-------------------------------------+
| 2 |           | 設定項目値管理 | 作業実行の出力結果（ソース          |
|   |           |                | ファイル）と、パラメータシートの項  |
|   |           |                | 目の紐づけ設定を行い、収集機能で登  |
|   |           |                | 録する対象パラメータを管理します。  |
+---+-----------+----------------+-------------------------------------+

#. **Ansibleコンソールのメニュー**

..

   各Ansibleコンソールに対応するメニュー一覧を以下に記述します。

表 3-2 Ansible driverコンソール メニュー/画面一覧

+---+---+----+---+--------------+----------------------------------------+
| N | メ |   |   | メ           | 説明                                   |
| o | ニ |   |   | ニュー・画面 |                                        |
|   | ュ |   |   |              |                                        |
|   | ー |   |   |              |                                        |
|   | グ |   |   |              |                                        |
|   | ル |   |   |              |                                        |
|   | ー |   |   |              |                                        |
|   | プ |   |   |              |                                        |
+===+===+====+===+==============+========================================+
|   | * |    |   |              |                                        |
|   | * |    |   |              |                                        |
|   | A |    |   |              |                                        |
|   | n |    |   |              |                                        |
|   | s |    |   |              |                                        |
|   | i |    |   |              |                                        |
|   | b |    |   |              |                                        |
|   | l |    |   |              |                                        |
|   | e |    |   |              |                                        |
|   | コ |   |   |              |                                        |
|   | ン |   |   |              |                                        |
|   | ソ |   |   |              |                                        |
|   | ー |   |   |              |                                        |
|   | ル |   |   |              |                                        |
|   | * |    |   |              |                                        |
|   | * |    |   |              |                                        |
+---+---+----+---+--------------+----------------------------------------+
|   |   |    |   |              |                                        |
|   |   |    |   |              |                                        |
|   |   | Le |   |              |                                        |
|   | L | ga | P |              |                                        |
|   | e | cy | i |              |                                        |
|   | g |    | o |              |                                        |
|   | a |    | n |              |                                        |
|   | c | Ro | e |              |                                        |
|   | y | le | e |              |                                        |
|   |   |    | r |              |                                        |
+---+---+----+---+--------------+----------------------------------------+
| 1 | * | *  | * | 作業管理     | 作業実行履歴を管理します               |
| 4 | * | *○ | * |              |                                        |
|   | ○ | ** | ○ |              | 収集機能によるパラメータシ             |
|   | * |    | * |              | ートの登録状況、実行ログを参照します。 |
|   | * |    | * |              |                                        |
+---+---+----+---+--------------+----------------------------------------+

.. image:: ./media/image7.png
   :width: 6.00372in
   :height: 2.87662in

**図 3.1‑1作業管理画面**

収集機能の利用手順
==================

収集機能の利用手順について説明します

作業フロー
----------

   収集機能の実施における標準的なフローは以下のとおりです。

   ITA　Ansible-Driverの利用方法は、「利用手順マニュアル_Ansible-Driver」を参照してください。

   ITA　基本コンソールの利用方法は、「利用手順マニュアル_基本コンソール」を参照してください。

収集機能作業フロー
~~~~~~~~~~~~~~~~~~

以下は、Ansible-Legacyで作業を実行するまでの流れです。

**
**

-  **作業フロー詳細と参照先**

#. | **収集機能用のユーザーの作成
     **\ ITA
     管理コンソールの機器一覧の画面から、収集機能用のユーザーを登録します。
   | 登録方法は「利用手順マニュアル_管理コンソール」
     を参照してください。

#. **収集機能用のロールの作成**

ITA管理コンソールのロール一覧の画面から、収集機能用のロールを登録します。

登録方法は「利用手順マニュアル_管理コンソール」 を参照してください。

3. **ロール・ユーザーの紐づけ**

ITA管理コンソールのロール・ユーザー紐付の画面から、ロールの紐づけを行います。

登録方法は「利用手順マニュアル_管理コンソール」 を参照してください。

4. **収集インターフェース情報の登録**

Ansible共通コンソールの収集インターフェース情報の画面から、接続情報を登録します。

詳細は「5.1.1 収集インターフェース情報」を参照してください。

5. | **パラメータシート（ホスト/オペレーションあり）の作成
     **\ メニュー作成コンソールのメニュー定義/作成の画面からのパラメータシートを作成します。
   | 詳細は 「利用手順マニュアル_メニュー作成機能」を参照してください。

6. **収集項目値管理の登録**

Ansible共通コンソールの収集項目値管理の画面から、ソースファイルとパラメータシートの項目の紐付情報の登録をします。

詳細は「5.1.2収集項目値管理」を参照してください。

7. **作業準備
   **\ 作業実行のための準備を行います。。

詳細は、「利用手順マニュアル_Ansible-Driver」、「利用手順マニュアル_Symphony」、「利用手順マニュアル_Conductor」
を参照してください。

8. **作業実行
   **\ 実行日時、投入オペレーション、Movement、ワークフローを選択し処理の実行を指示します。

実行について「利用手順マニュアル_Ansible-Driver」、「利用手順マニュアル_Symphony」、「利用手順マニュアル_Conductor」
を参照してください。

9. **収集機能実行**

作業実行が完了した作業Noを収集機能の対象として、パラメータシートへの登録処理を実施します。

詳細は「 5.3　BackYardコンテンツ」を参照してください。

10. **収集状況確認
    **\ Ansible-Legacy/Ansible-Pioneer/Ansible-LegacyRoleコンソールの作業管理の画面では、完了した作業の収集状態の確認、ログファイルがDL可能です。

詳細は「5.2.1収集状況の確認」を参照してください。

収集機能・操作方法説明
======================

本章では、収集機能で利用する各コンソールの機能について説明します。

登録方法の詳細は、関連マニュアルの「利用手順マニュアル_基本コンソール」をご参照下さい。

Ansible 共通コンソール
----------------------

   本節では、Ansible共通コンソールでの操作について記載します。

収集インターフェース情報
~~~~~~~~~~~~~~~~~~~~~~~~

(1) [収集インターフェース情報]では、収集機能で利用するITAの標準RESTAPIを利用する為、RESTAPIアクセス用の接続インターフェース情報の更新を行います。

    .. image:: ./media/image10.png
       :width: 5.65382in
       :height: 2.70023in

**図 5.1‑1サブメニュー画面（収集インターフェース情報）**

(2) 「一覧」-「更新」ボタンより、収集インターフェース情報の登録を行います。

    .. image:: ./media/image11.png
       :width: 5.475in
       :height: 0.70833in

図 5.1‑2 更新画面（収集インターフェース情報）

(3) | 収集インターフェース情報画面の項目一覧は以下のとおりです。
       | 収集インターフェース情報が未登録または、複数レコード登録されている状態で作業実行した場合、\ **収集機能によるパラメータシートへの登録はされません**\ 。

**表 5.1‑1　登録画面項目一覧（インタフェース情報）**

+-------------+-----------------------------+----+------+-------------+
| **項目**    | **説明**                    | ** | **入 | *           |
|             |                             | 入 | 力形 | *制約事項** |
|             |                             | 力 | 式** |             |
|             |                             | ** |      |             |
|             |                             |    |      |             |
|             |                             | ** |      |             |
|             |                             | 必 |      |             |
|             |                             | 須 |      |             |
|             |                             | ** |      |             |
+=============+=============================+====+======+=============+
|             |                             |    |      |             |
+-------------+-----------------------------+----+------+-------------+
| ホスト名    | 使用するホスト名を入力      | 〇 | 手動 |             |
|             |                             |    | 入力 |             |
|             | 初期値：localhost           |    |      |             |
+-------------+-----------------------------+----+------+-------------+
| IP          | 使用するIPを入力            | 〇 | 手動 |             |
|             |                             |    | 入力 |             |
|             | 初期値：127.0.0.1           |    |      |             |
+-------------+-----------------------------+----+------+-------------+
| R           | 使用するIT                  |    | 手動 | ※1          |
| ESTユーザー | AユーザーのログインIDを入力 |    | 入力 |             |
+-------------+-----------------------------+----+------+-------------+
| RES         | 使用するITAユーザー         |    | 手動 |             |
| Tパスワード | のログインパスワードを入力  |    | 入力 |             |
+-------------+-----------------------------+----+------+-------------+
| REST方式    | ホスト名、IPの              | 〇 | リ   |             |
|             | どちらか使用するものを選択  |    | スト |             |
|             |                             |    | 選択 |             |
|             | -  IP                       |    |      |             |
|             |                             |    |      |             |
|             | -  ホスト名                 |    |      |             |
+-------------+-----------------------------+----+------+-------------+
| プロトコル  | 使用するプロトコルを入力    | 〇 | 手動 |             |
|             |                             |    | 入力 |             |
|             | 初期値：http                |    |      |             |
+-------------+-----------------------------+----+------+-------------+
| ポート      | 使用するポートを入力        | 〇 | 手動 |             |
|             |                             |    | 入力 |             |
|             | 初期値：80                  |    |      |             |
+-------------+-----------------------------+----+------+-------------+
| 備考        | 自由記述欄です。            | -  | 手動 |             |
|             |                             |    | 入力 |             |
+-------------+-----------------------------+----+------+-------------+

※1　RESTユーザーに入力されたユーザーは、以下が必須にとなります。

-  ユーザーが所属しているロールが、作成されたパラメータシートのメニューのアクセス権/アクセス許可ロールをもっている。

-  メニューのロール情報にて、ユーザーに紐づくロールがメンテナンス可である。

..

   ユーザー、ロールの作成、紐付、について「利用手順マニュアル_管理コンソール」を参照してください。

収集項目値管理
~~~~~~~~~~~~~~

(1) [収集項目値管理]では、収集項目とパラメータシートの項目の紐付設定を行います。

    .. image:: ./media/image12.png
       :width: 5.74716in
       :height: 2.75357in

**図 5.1‑3サブメニュー画面（収集項目値管理）**

(4) 「一覧」-「登録開始」ボタンより、収集項目の登録を行います。

    .. image:: ./media/image13.png
       :width: 5.47222in
       :height: 0.85139in

図 5.1‑4 登録画面（収集項目値管理）

(5) 収集項目値管理画面の項目一覧は以下のとおりです。

**表 5.1‑1　登録画面項目一覧（収集項目値管理）**

+------+------------+-----------------------+----+------+-------------+
| **項 |            | **説明**              | ** | **入 | *           |
| 目** |            |                       | 入 | 力形 | *制約事項** |
|      |            |                       | 力 | 式** |             |
|      |            |                       | ** |      |             |
|      |            |                       |    |      |             |
|      |            |                       | ** |      |             |
|      |            |                       | 必 |      |             |
|      |            |                       | 須 |      |             |
|      |            |                       | ** |      |             |
+======+============+=======================+====+======+=============+
|      |            |                       |    |      |             |
+------+------------+-----------------------+----+------+-------------+
| 収   | パース形式 | ソースファイル        | 〇 | リ   |             |
| 集項 |            | のファイル形式を選択  |    | スト |             |
| 目(F |            |                       |    | 選択 |             |
| ROM) |            |                       |    |      |             |
+------+------------+-----------------------+----+------+-------------+
|      | PREFIX(フ  | ソース                | 〇 | 手動 | ※1          |
|      | ァイル名)  | ファイルの拡張子を除  |    | 入力 |             |
|      |            | いたファイル名を入力  |    |      |             |
+------+------------+-----------------------+----+------+-------------+
|      | 変数名     | 変数名を入力          | 〇 | 手動 | ※1          |
|      |            |                       |    | 入力 |             |
+------+------------+-----------------------+----+------+-------------+
|      | メ         | 変数が、複数具体値    |    | 手動 | ※1          |
|      | ンバー変数 | 、多段変数の場合入力  |    | 入力 |             |
+------+------------+-----------------------+----+------+-------------+
| パラ | メニュ     | メニュー作            | 〇 | リ   |             |
| メー | ーグループ | 成機能で作成されたメ  |    | スト |             |
| タシ |            | ニューの一覧から選択  |    | 選択 |             |
| ート |            |                       |    |      |             |
| (TO) |            | グ                    |    |      |             |
|      |            | ループ名：メニュー名  |    |      |             |
+------+------------+-----------------------+----+------+-------------+
|      | メニュー   |                       |    |      |             |
+------+------------+-----------------------+----+------+-------------+
|      | 項目       | 項目を選択            | 〇 | リ   | ※2          |
|      |            |                       |    | スト |             |
|      |            |                       |    | 選択 |             |
+------+------------+-----------------------+----+------+-------------+

※1ファイル名、変数、メンバー変数入力値の例

※2　同一の「パラメータシート(TO)-メニューグループ：メニュー-項目」に対して、複数の「PREFIX(ファイル名)-
変数名」を設定している場合、ファイル順に処理が実行されます。詳しくは「
7.2収集実行例」参照。

+-----------------------------------------------------------------------+
| e.g.) 通常変数の構造の変数の場合                                      |
|                                                                       |
| ■ファイル名：SAMPLE.yml                                               |
|                                                                       |
| ■ファイルの内容                                                       |
|                                                                       |
| VAR_sample_config_1: yes                                              |
|                                                                       |
| VAR_sample_config_2: test_parameter                                   |
|                                                                       |
| ■収集値項目管理の収集項目(FROM)の入力可能な値                         |
|                                                                       |
| PREFIX(ファイル名)： SAMPLE                                           |
|                                                                       |
| 変数名： VAR_sample_config_1                                          |
|                                                                       |
| VAR_sample_config_2                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| e.g.) 複数具体値の構造の変数の場合                                    |
|                                                                       |
| ■ファイル名：SAMPLE_2.yml                                             |
|                                                                       |
| ■ファイルの内容                                                       |
|                                                                       |
| VAR_sample2_conf:                                                     |
|                                                                       |
| - SAMPLE1                                                             |
|                                                                       |
| - SAMPLE2                                                             |
|                                                                       |
| - SAMPLE3                                                             |
|                                                                       |
| ■収集値項目管理の収集項目(FROM)の入力可能な値                         |
|                                                                       |
| PREFIX(ファイル名)： SAMPLE_2                                         |
|                                                                       |
| 変数名： VAR_sample2_conf                                             |
|                                                                       |
| メンバー変数： [0]                                                    |
|                                                                       |
| [1]                                                                   |
|                                                                       |
| [2]                                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| e.g.) 複数具体値の構造の変数の場合                                    |
|                                                                       |
| ■ファイル名：RH_sshd.yml                                              |
|                                                                       |
| ■ファイルの内容                                                       |
|                                                                       |
| VAR_RH_sshd_config:                                                   |
|                                                                       |
| - key: PermitRootLogin                                                |
|                                                                       |
| value: yes                                                            |
|                                                                       |
| - key: PasswordAuthentication                                         |
|                                                                       |
| value: no                                                             |
|                                                                       |
| ■収集値項目管理の収集項目(FROM)の入力可能な値                         |
|                                                                       |
| PREFIX(ファイル名)： RH_sshd                                          |
|                                                                       |
| 変数名： VAR_RH_sshd_config:                                          |
|                                                                       |
| メンバー変数： [0].key                                                |
|                                                                       |
| [0].value                                                             |
|                                                                       |
| [1].key                                                               |
|                                                                       |
| [1].value                                                             |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| e.g.) 複数具体値の構造の変数の場合2                                   |
|                                                                       |
| ■ファイル名：RH_snmp.yml                                              |
|                                                                       |
| ■ファイルの内容                                                       |
|                                                                       |
| VAR_RH_snmpd_info:                                                    |
|                                                                       |
| com2sec:                                                              |
|                                                                       |
| - sec_name: "testsec"                                                 |
|                                                                       |
| source: "192.168.1.0/24"                                              |
|                                                                       |
| community: "public"                                                   |
|                                                                       |
| - sec_name: "local"                                                   |
|                                                                       |
| source: "localhost"                                                   |
|                                                                       |
| community: "private"                                                  |
|                                                                       |
| ■収集値項目管理の収集項目(FROM)の入力可能な値                         |
|                                                                       |
| PREFIX(ファイル名)： RH_snmp                                          |
|                                                                       |
| 変数名： VAR_RH_snmp_config:                                          |
|                                                                       |
| メンバー変数： com2sec[0].sec_name                                    |
|                                                                       |
| com2sec[0].source                                                     |
|                                                                       |
| com2sec[0].community                                                  |
|                                                                       |
| com2sec[1].sec_name]                                                  |
|                                                                       |
| com2sec[1].source                                                     |
|                                                                       |
| com2sec[1].community                                                  |
+=======================================================================+
+-----------------------------------------------------------------------+

Ansible-Legacy、Ansible-Pioneer、Ansible-LegacyRoleコンソール
-------------------------------------------------------------

収集状況の確認
~~~~~~~~~~~~~~

   各コンソール（Ansible-Legacy/Ansible-Pioneer/Ansible-LegacyRole）の作業管理の画面では、

   完了した作業の収集状態の確認、ログファイルがDL可能です。

.. image:: ./media/image7.png
   :width: 5.78688in
   :height: 2.77273in

**図 5.2‑1作業管理画面**

**表 5.2‑1　作業管理画面収集状況詳細**

+----------+--------------------------------------------------+--------+
| **項目** | **説明**                                         | **     |
|          |                                                  | 備考** |
+==========+==================================================+========+
| ス       | 収集機能の実行状況の表示                         | ※      |
| テータス |                                                  |        |
|          | 対象外：収集機能対象外　（対象ファイルなし）     |        |
|          |                                                  |        |
|          | 収集済み：収集機能実施済み                       |        |
|          |                                                  |        |
|          | 収集                                             |        |
|          | 済み（通知あり）：登録/更新中に不備があった場合  |        |
|          |                                                  |        |
|          | 収集エラー：                                     |        |
|          | Movementのオペレーション、ホストに不備がある場合 |        |
+----------+--------------------------------------------------+--------+
| 収集ログ | 収集機能実行のログをダウンロード                 |        |
+----------+--------------------------------------------------+--------+

**　表 5.2‑2　収集状況詳細**

+--------+---------+-----------+--------------+------------+--------+
| **作業 |         | **収集機  | **収集状況** |            |        |
| 状態** |         | 能対象**  |              |            |        |
+========+=========+===========+==============+============+========+
| **     | **対    |           | **           | **         | **     |
| ステー | 象ファ  |           | ステータス** | 収集ログ** | 備考** |
| タス** | イル**  |           |              |            |        |
+--------+---------+-----------+--------------+------------+--------+
| 完     | なし    | 対象外    | 空           | 空         |        |
| 了以外 |         |           |              |            |        |
+--------+---------+-----------+--------------+------------+--------+
| 完     | あり    | 対象外    | 空           | 空         |        |
| 了以外 |         |           |              |            |        |
+--------+---------+-----------+--------------+------------+--------+
| 完了   | なし    | 対象      | 対象外       | ログフ     |        |
|        |         |           |              | ァイルあり |        |
+--------+---------+-----------+--------------+------------+--------+
| 完了   | あり    | 対象      | 収集済み     | ログフ     |        |
|        |         |           |              | ァイルあり |        |
+--------+---------+-----------+--------------+------------+--------+
| 完了   | あり    | 対象      | 収集済み     | ログフ     |        |
|        |         |           | （通知あり） | ァイルあり |        |
+--------+---------+-----------+--------------+------------+--------+

※ステータスの表記について

-  作業状態が完了でない場合、収集機能対象外の為、収集状況は更新されないため、空のままとなります。

-  作業状態が完了で、収集対象ファイルが存在しない場合、ステータスは収集済み、収集ログは空の状態となります。

-  収集インターフェース情報、設定項目値管理、メニューのアクセス権/アクセス許可ロールの不備により、RESTAPIの登録処理が失敗した場合でも収集済み（通知あり）となります。詳細は、収集ログ内を参照。

ログファイル出力内容例

+-----------------------------------------------------------------------+
| e.g.) ログファイル出力内容例 (登録処理成功)                           |
|                                                                       |
| 2020-11-13 13:51:02 Collect START ( ホスト名:ita-sample               |
| ファイル名:RH_snmpd )                                                 |
|                                                                       |
| 2020-11-13 13:51:02 REST DATA ( ホスト名: ita-sample メニューID:      |
| 0000000004 オペレーションNO: 1 )                                      |
|                                                                       |
| Array                                                                 |
|                                                                       |
| (                                                                     |
|                                                                       |
| [0] =>                                                                |
| http://127.0.0.1:80/default/menu/07_rest_api_ver1.php?no=0000000004   |
|                                                                       |
| [1] => [["更新","","3","ita-sample","","","","","","2023\\/10\\/26    |
| 16:35_1:OP001","Root <root@localhost> (configure                      |
| \\/etc\\/snmp\\/snmp.local.conf)","Unknown (edit                      |
| \\/etc\\/snmp\\/snmp                                                  |
| d.conf)","public","notConfigUser","","","T_20201111115557819037",""]] |
|                                                                       |
| [2] =>                                                                |
| {"status":"SUCCEED","resultdata":{"LI                                 |
| ST":{"NORMAL":{"register":{"name":"登録","ct":0},"update":{"name":"更 |
| 新","ct":1},"delete":{"name":"廃止","ct":0},"revive":{"name":"復活",  |
| "ct":0},"error":{"name":"エラー","ct":0}},"RAW":[["000","200",""]]}}} |
|                                                                       |
| )                                                                     |
|                                                                       |
| 2020-11-13 13:51:02 Collect END ( ホスト名:ita-sample                 |
| ファイル名:RH_snmpd )                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| e.g.) ログファイル出力内容例 (登録処理失敗)                           |
|                                                                       |
| 2020-11-06 13:32:52 Collect START ( ホスト名:ita-sample               |
| ファイル名:RH_snmpd )                                                 |
|                                                                       |
| 2020-11-06 13:32:52 [処理]RESTアクセスに失敗しました。                |
|                                                                       |
| Array                                                                 |
|                                                                       |
| (                                                                     |
|                                                                       |
| [0] =>                                                                |
| http://127.0.0.1:80/default/menu/07_rest_api_ver1.php?no=0000000005   |
|                                                                       |
| [1] => [["登録","","","ita-sample","","","","","","2023\\/10\\/26     |
| 16:35_1:OP001","Root <root@localhost>(configure                       |
| \\/etc\\/snmp\\/snmp.local.conf)","Unknown (edit                      |
| \\/etc\\/snmp\\/snmpd.conf)","public","notConfigUser","","","",""]]   |
|                                                                       |
| [2] => {"Error":メンテナンス権限がありません。","Exception":"Generic  |
| error","StackTrace":"none"}                                           |
|                                                                       |
| )                                                                     |
|                                                                       |
| 2020-11-06 13:32:52 Collect END ( ホスト名:ita-sample                 |
| ファイル名:RH_snmpd )                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| e.g.) ログファイル出力内容例 (対象外)                                 |
|                                                                       |
| 2020-11-05 16:55:31                                                   |
| [処理]対象機器が登録されていな                                        |
| いか、廃止されているため、登録、更新処理をスキップ(ホスト名:ita-test) |
+=======================================================================+
+-----------------------------------------------------------------------+

BackYardコンテンツ
------------------

1. .. rubric:: パラメータシートへの登録処理の概要
      :name: パラメータシートへの登録処理の概要

   1. 収集インターフェース情報の取得

   2. 正常に完了した作業の一覧を取得

..

   収集対象ステータス： 完了

3. 収集対象作業Noから以下の情報を取得

-  オペレーション情報

-  対象ホスト

-  対象ソースファイル

   1. 対象のホストが機器一覧に登録されているか問い合わせ

..

   登録： 収集対象

   未登録： 対象外

2. 対象ソースファイルと収集項目値管理から対象パラメータシートのメニューIDを取得

..

   ※対象ソースファイルが複数ある場合、ファイル名の昇順で処理を実行します。

3. (1)～（4）の情報からRESTAPIのパラメータを生成

..

   対象のメニューIDに対して、データの問い合わせを実施し、RESTAPIの実行種別を判定

   登録：　一意のオペレーション、ホスト組み合わせのデータが登録されていない

   更新：　一意のオペレーション、ホスト組み合わせのデータが登録されている

4. ITA標準RESTAPI機能にて、データの登録/更新を実施します。

5. 作業Noに収集状況のステータスを更新

..

   なお、パラメータシートへのデータ登録のタイミングは自動プロセスの起動周期に依存します。

   起動周期の変更については、後述「
   **6.2メンテナンス方法について**\ 」を参照してください。

   登録・更新されたレコードのアクセス権/アクセス許可ロールは、収集対象の作業結果のアクセス権/アクセス許可ロールを継承します。

   対象の作業結果については、別紙「Exastro-ITA_利用手順マニュアル_Ansible-driver」を参照してください。

運用操作
========

本機能を活用する操作は、クライアントPCのブラウザ画面からのユーザー利用による入力だけでなく、システム運用・保守による操作もあります。用意している運用・保守の操作は次のとおりです。

メンテナンス
------------

   収集機能のプロセスの開始/停止/再起動に必要なファイルは以下となります。

+--------------------------------------+-------------------------------+
| **説明**                             | **対象ファイル名**            |
+======================================+===============================+
| パラメータ自動登録                   | ky_std_                       |
|                                      | synchronize-Collector.service |
| 作業実行が完了した、作業結果か       |                               |
| ら、設定項目値管理に登録した情報を元 |                               |
| に、パラメータシートへの登録を行う。 |                               |
+--------------------------------------+-------------------------------+

..

   対象ファイルは「/usr/lib/systemd/system」に格納されています。

   プロセス起動/停止/再起動の方法は次の通りです。

   root権限でコマンドを実行してください。

#. プロセス起動

#. プロセス停止

#. プロセス再起動

..

   各対象ファイル名に置き換えて起動/停止/再起動を行ってください。

メンテナンス方法について
------------------------

   ①　NORMALレベルへの変更

   　以下のファイルの8行目「DEBUG」を「NORMAL」に書き換えます。

   　ログレベル設定ファイル：
   <インストールディレクトリ>/ita-root/confs/backyardconfs/ita_env

   　

   ②　DEBUGレベルへの変更

   　以下のファイルの8行目「NORMAL」を「DEBUG」に書き換えます。

   　ログレベル設定ファイル：
   <インストールディレクトリ>/ita-root/confs/backyardconfs/ita_env

   ③ 起動周期の変更

   　各対象ファイルのExecStartの5番目のパラメータを変更します。（単位:秒）

   　例外を除き起動周期はデフォルト値の使用をしてください。

書き換え後、\ **プロセス再起動(restart)後に有効になります。**

ログファイルの出力先：
*<インストールディレクトリ>/ita-root/logs/backyardlogs*

1. .. rubric:: 付録
      :name: 付録

   1. .. rubric:: 参考資材
         :name: 参考資材

..

   以下、IaC(Playbook、Role)の参考例となります。

1. Ansible Playbook Collection（OS設定収集）

..

   https://github.com/exastro-suite/playbook-collection-docs/blob/master/README.ja.md

2. Ansibleコンフィグ取得、パラメータ生成Playbook

..

   makeYml_Ansible.yml

+-----------------------------------------------------------------------+
| - name: make yaml file                                                |
|                                                                       |
| blockinfile:                                                          |
|                                                                       |
| create: yes                                                           |
|                                                                       |
| mode: 0644                                                            |
|                                                                       |
| insertbefore: EOF                                                     |
|                                                                       |
| marker: ""                                                            |
|                                                                       |
| dest: "/tmp/Ansible_conf.yml"                                         |
|                                                                       |
| content: \|                                                           |
|                                                                       |
| ansible_architecture: {{ ansible_architecture }}                      |
|                                                                       |
| ansible_bios_version: {{ ansible_bios_version }}                      |
|                                                                       |
| ansible_default_ipv4__address: {{ ansible_default_ipv4.address }}     |
|                                                                       |
| ansible_default_ipv4__interface: {{ ansible_default_ipv4.interface }} |
|                                                                       |
| ansible_default_ipv4__network: {{ ansible_default_ipv4.network }}     |
|                                                                       |
| ansible_distribution: {{ ansible_distribution }}                      |
|                                                                       |
| ansible_distribution_file_path: {{ ansible_distribution_file_path }}  |
|                                                                       |
| ansible_distribution_file_variety: {{                                 |
| ansible_distribution_file_variety }}                                  |
|                                                                       |
| ansible_distribution_major_version: {{                                |
| ansible_distribution_major_version }}                                 |
|                                                                       |
| ansible_distribution_release: {{ ansible_distribution_release }}      |
|                                                                       |
| ansible_distribution_version: {{ ansible_distribution_version }}      |
|                                                                       |
| ansible_machine: {{ ansible_machine }}                                |
|                                                                       |
| ansible_memtotal_mb: {{ ansible_memtotal_mb }}                        |
|                                                                       |
| ansible_nodename: {{ ansible_nodename }}                              |
|                                                                       |
| ansible_os_family: {{ ansible_os_family }}                            |
|                                                                       |
| ansible_pkg_mgr: {{ ansible_pkg_mgr }}                                |
|                                                                       |
| ansible_processor_cores: {{ ansible_processor_cores }}                |
|                                                                       |
| ansible_processor_count: {{ ansible_processor_count }}                |
|                                                                       |
| ansible_processor_threads_per_core: {{                                |
| ansible_processor_threads_per_core }}                                 |
|                                                                       |
| ansible_processor_vcpus: {{ ansible_processor_vcpus }}                |
|                                                                       |
| ansible_product_name: {{ ansible_product_name }}                      |
|                                                                       |
| ansible_product_serial: {{ ansible_product_serial }}                  |
|                                                                       |
| ansible_product_uuid: {{ ansible_product_uuid }}                      |
|                                                                       |
| ansible_product_version: {{ ansible_product_version }}                |
|                                                                       |
| ansible_python__executable: {{ ansible_python.executable }}           |
|                                                                       |
| ansible_python_version: {{ ansible_python_version }}                  |
|                                                                       |
| ansible_service_mgr: {{ ansible_service_mgr }}                        |
|                                                                       |
| ansible_php_config: php.ini                                           |
|                                                                       |
| - name: Copy the make yaml file to local                              |
|                                                                       |
| fetch:                                                                |
|                                                                       |
| src: "/tmp/Ansible_conf.yml"                                          |
|                                                                       |
| dest: "{{ \__parameter_dir_\_ }}/{{ inventory_hostname }}/"           |
|                                                                       |
| flat: yes                                                             |
|                                                                       |
| - name: get php config                                                |
|                                                                       |
| fetch:                                                                |
|                                                                       |
| src: /etc/php.ini                                                     |
|                                                                       |
| dest: "{{ \__parameters_file_dir_\_ }}/{{ inventory_hostname }}/"     |
|                                                                       |
| flat: yes                                                             |
+=======================================================================+
+-----------------------------------------------------------------------+

..

   ※　makeYml_Ansible.yml実行して、収集対象のソースファイル(yaml)を生成する場合、gather_factsを有効にする必要があります。

   「Ansible-Legacy」-「Movement一覧」編集時、「ヘッダーセクション」に以下を記載する。

   設定変更については、「利用手順マニュアル
   Ansible-driver」を参照してください。

   e.g) gather_facts有効設定例

+-----------------------------------------------------------------------+
| - hosts: all                                                          |
|                                                                       |
| remote_user: "{{ \__loginuser_\_ }}"                                  |
|                                                                       |
| gather_facts: yes                                                     |
|                                                                       |
| become: yes                                                           |
+=======================================================================+
+-----------------------------------------------------------------------+

収集実行例
----------

複数ファイルの同一メニューを対象とした場合
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

収集項目値管理にて、一つの「メニュー-項目」に対して、複数の「PREFIX(ファイル名)-変数名」の設定をしている場合、対象ホストの収集対象ディレクトリ内に、該当する複数のソースファイルがある場合の収集処理の例について記載します。

収集対象ファイル

+-----------------------------------------------------------------------+
| 【上位ディレクトリ】                                                  |
|                                                                       |
| \|- \_parameters 　                                                   |
|                                                                       |
| \|- ita-sample01                                                      |
|                                                                       |
| \|- SAMPLE_01.yml 　                                                  |
|                                                                       |
| \|- SAMPLE_02.yml 　                                                  |
+=======================================================================+
+-----------------------------------------------------------------------+

収集項目値管理設定

+-----------------------------------------------------------------------+
| ■ファイル名：SAMPLE_01.yml                                            |
|                                                                       |
| 　　　　　　　　 SAMPLE_02.yml                                        |
|                                                                       |
| ■ファイルの内容                                                       |
|                                                                       |
| +--------------------------------+--------------------------------+   |
| | SAMPLE_01.yml　                | SAMPLE_02.yml                  |   |
| +================================+================================+   |
| | VAR_sample_config_1: 1         | VAR_sample_config_1: “A”       |   |
| |                                |                                |   |
| | VAR_sample_config_2: 2         | VAR_sample_config_B: “B”       |   |
| |                                |                                |   |
| | VAR_sample_config_3: 3         | VAR_sample_config_X: “X”       |   |
| +--------------------------------+--------------------------------+   |
|                                                                       |
| ■収集値項目管理の設定と対象メニュー項目の収集例                       |
|                                                                       |
| e.g) 収集値項目管理の設定と対象メニュー-項目                          |
|                                                                       |
| .. image:: ./media/image14.png                                        |
|    :width: 6.11686in                                                  |
|    :height: 2.26773in                                                 |
|                                                                       |
| .. image:: ./media/image15.png                                        |
|    :width: 6.09421in                                                  |
|    :height: 0.32738in                                                 |
|                                                                       |
| ■対象ファ                                                             |
| イル、収集値項目管理の設定内容に沿って、ファイル単位に収集処理を実行  |
|                                                                       |
| 1. SAMPLE_01.ymlの登録処理（登録）                                    |
|                                                                       |
| .. image:: ./media/image16.png                                        |
|    :width: 6.00785in                                                  |
|    :height: 0.51786in                                                 |
|                                                                       |
| 2.SAMPLE_02.ymlの登録処理（更新）                                     |
|                                                                       |
| .. image:: ./media/image17.png                                        |
|    :width: 6in                                                        |
|    :height: 0.52304in                                                 |
|                                                                       |
| 3.収集機能完了後のレコードの状態                                      |
|                                                                       |
| .. image:: ./media/image15.png                                        |
|    :width: 6.06086in                                                  |
|    :height: 0.52834in                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

収集対象ファイルの値の取り扱い
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Yaml形式で出力された収集対象ファイルについて、パラメータシートへの登録処理時の値の取り扱いについて以下として扱います。

Sample.yml

+-----------------------------------------------------------------------+
| VAR_TEST: TEST                                                        |
|                                                                       |
| VAR_STR_TEST1: 'TEST1'                                                |
|                                                                       |
| VAR_STR_TEST2: "TEST2"                                                |
|                                                                       |
| VAR_null: null                                                        |
|                                                                       |
| VAR_NULL: NULL                                                        |
|                                                                       |
| VAR_STR_null: "null"                                                  |
|                                                                       |
| VAR_STR_NULL: "NULL"                                                  |
|                                                                       |
| VAR_true: true                                                        |
|                                                                       |
| VAR_false: false                                                      |
|                                                                       |
| VAR_STR_true: "true"                                                  |
|                                                                       |
| VAR_STR_false: "false"                                                |
|                                                                       |
| VAR_YES: YES                                                          |
|                                                                       |
| VAR_NO: NO                                                            |
|                                                                       |
| VAR_STR_YES: "YES"                                                    |
|                                                                       |
| VAR_STR_NO: "NO"                                                      |
|                                                                       |
| VAR_NON:                                                              |
|                                                                       |
| VAR_Quotation: ''                                                     |
|                                                                       |
| VAR_WQuotation: ""                                                    |
+=======================================================================+
+-----------------------------------------------------------------------+

表 7-1　収集対象YAML(sample.yml)のキーと値

+---+--------------------------+-----------------------+-------------+
| * | **キー**                 | **値**                | **備考**    |
| * |                          |                       |             |
| N |                          |                       |             |
| o |                          |                       |             |
| * |                          |                       |             |
| * |                          |                       |             |
+===+==========================+=======================+=============+
| 1 | VAR_TEST                 | TEST                  |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 2 | VAR_STR_TEST1            | 'TEST1'               |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 3 | VAR_STR_TEST2            | "TEST2"               |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 4 | VAR_null                 | null                  |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 5 | VAR_NULL                 | NULL                  |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 6 | VAR_STR_null             | "null"                |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 7 | VAR_STR_NULL             | "NULL"                |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 8 | VAR_true                 | true                  |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 9 | VAR_false                | false                 |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_STR_true             | "true"                |             |
| 0 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_STR_false            | "false"               |             |
| 1 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_YES                  | YES                   |             |
| 2 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_NO                   | NO                    |             |
| 3 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_STR_YES              | "YES"                 |             |
| 4 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_STR_NO               | "NO"                  |             |
| 5 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_NON                  |                       |             |
| 6 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_Quotation            | ''                    |             |
| 7 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+
| 1 | VAR_WQuotation           | ""                    |             |
| 8 |                          |                       |             |
| . |                          |                       |             |
|   |                          |                       |             |
+---+--------------------------+-----------------------+-------------+

表 7-2　収集対象YAML(sample.yml)の収集

+---+--------------------+---------------------+-----------+---------+
| * | **収集対象**       | **パラメ            | **        | **WE    |
| * |                    | ータシート項目名**  | RESTAPI** | B画面** |
| N | **（キー:値）**    |                     |           |         |
| o |                    |                     |           |         |
| * |                    |                     |           |         |
| * |                    |                     |           |         |
+===+====================+=====================+===========+=========+
| 1 | VAR_TEST: TEST     | パラメータ/VAR_TEST | "TEST"    | TEST    |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 2 | VAR_STR_TEST1:     | パラメ              | "TEST1"   | TEST1   |
| . | 'TEST1'            | ータ/VAR_STR_TEST1  |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 3 | VAR_STR_TEST2:     | パラメ              | "TEST2"   | TEST2   |
| . | "TEST2"            | ータ/VAR_STR_TEST2  |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 4 | VAR_null: null     | パラメータ/VAR_null | null      |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 5 | VAR_NULL: NULL     | パラメータ/VAR_NULL | null      |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 6 | VAR_STR_null:      | パラ                | "null"    | null    |
| . | "null"             | メータ/VAR_STR_null |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 7 | VAR_STR_NULL:      | パラ                | "NULL"    | NULL    |
| . | "NULL"             | メータ/VAR_STR_NULL |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 8 | VAR_true: true     | パラメータ/VAR_true | "1"       | 1       |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 9 | VAR_false: false   | パ                  | ""        |         |
| . |                    | ラメータ/VAR_false  |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_STR_true:      | パラ                | "true"    | true    |
| 0 | "true"             | メータ/VAR_STR_true |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_STR_false:     | パラメ              | "false"   | false   |
| 1 | "false"            | ータ/VAR_STR_false  |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_YES: YES       | パラメータ/VAR_YES  | "1"       | 1       |
| 2 |                    |                     |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_NO: NO         | パラメータ/VAR_NO   | ""        |         |
| 3 |                    |                     |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_STR_YES: "YES" | パラ                | "YES"     | YES     |
| 4 |                    | メータ/VAR_STR_YES  |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_STR_NO: "NO"   | パ                  | "NO"      | NO      |
| 5 |                    | ラメータ/VAR_STR_NO |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_NON:           | パラメータ/VAR_NON  | null      |         |
| 6 |                    |                     |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_Quotation: ''  | パラメ              | null      |         |
| 7 |                    | ータ/VAR_Quotation  |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+
| 1 | VAR_WQuotation: "" | パラメ              | null      |         |
| 8 |                    | ータ/VAR_WQuotation |           |         |
| . |                    |                     |           |         |
|   |                    |                     |           |         |
+---+--------------------+---------------------+-----------+---------+

..

   ※パラメータシートの値は、RESTAPIでFILTERの取得結果から、文字列に関して、””で囲った状態で記載しています。

   ※RESTAPI（FILTER）での取得結果例、WEB画面の表示結果例について記載しています。

-  対象パラメータシートの画面上の表示結果

.. image:: ./media/image18.png
   :width: 6.96252in
   :height: 1.98221in

-  対象パラメータシートのRESTAPI(FILTER)での取得結果

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONTENTS": {                                                         |
|                                                                       |
| "RECORD_LENGTH": 1,                                                   |
|                                                                       |
| "BODY": [                                                             |
|                                                                       |
| [                                                                     |
|                                                                       |
| "実行処理種別",                                                       |
|                                                                       |
| "廃止",                                                               |
|                                                                       |
| "No",                                                                 |
|                                                                       |
| "ホスト名",                                                           |
|                                                                       |
| "オペレーション/ID",                                                  |
|                                                                       |
| "オペレーション/オペレーション名",                                    |
|                                                                       |
| "オペレーション/基準日時",                                            |
|                                                                       |
| "オペレーション/実施予定日時",                                        |
|                                                                       |
| "オペレーション/最終実行日時",                                        |
|                                                                       |
| "オペレーション/オペレーション",                                      |
|                                                                       |
| "パラメータ/VAR_TEST",                                                |
|                                                                       |
| "パラメータ/VAR_STR_TEST1",                                           |
|                                                                       |
| "パラメータ/VAR_STR_TEST2",                                           |
|                                                                       |
| "パラメータ/VAR_null",                                                |
|                                                                       |
| "パラメータ/VAR_NULL",                                                |
|                                                                       |
| "パラメータ/VAR_STR_null",                                            |
|                                                                       |
| "パラメータ/VAR_STR_NULL",                                            |
|                                                                       |
| "パラメータ/VAR_true",                                                |
|                                                                       |
| "パラメータ/VAR_false",                                               |
|                                                                       |
| "パラメータ/VAR_STR_true",                                            |
|                                                                       |
| "パラメータ/VAR_STR_false",                                           |
|                                                                       |
| "パラメータ/VAR_YES",                                                 |
|                                                                       |
| "パラメータ/VAR_NO",                                                  |
|                                                                       |
| "パラメータ/VAR_STR_YES",                                             |
|                                                                       |
| "パラメータ/VAR_STR_NO",                                              |
|                                                                       |
| "パラメータ/VAR_NON",                                                 |
|                                                                       |
| "パラメータ/VAR_Quotation",                                           |
|                                                                       |
| "パラメータ/VAR_WQuotation",                                          |
|                                                                       |
| "アクセス権/アクセス許可ロール",                                      |
|                                                                       |
| "備考",                                                               |
|                                                                       |
| "最終更新日時",                                                       |
|                                                                       |
| "更新用の最終更新日時",                                               |
|                                                                       |
| "最終更新者"                                                          |
|                                                                       |
| ],                                                                    |
|                                                                       |
| [                                                                     |
|                                                                       |
| null,                                                                 |
|                                                                       |
| "",                                                                   |
|                                                                       |
| "1",                                                                  |
|                                                                       |
| "local",                                                              |
|                                                                       |
| "1",                                                                  |
|                                                                       |
| "OP01",                                                               |
|                                                                       |
| "2021/11/17 13:30",                                                   |
|                                                                       |
| "2021/11/23 16:04",                                                   |
|                                                                       |
| "2021/11/17 13:30",                                                   |
|                                                                       |
| "2021/11/23 16:04_1:OP01",                                            |
|                                                                       |
| "TEST",                                                               |
|                                                                       |
| "TEST1",                                                              |
|                                                                       |
| "TEST2",                                                              |
|                                                                       |
| null,                                                                 |
|                                                                       |
| null,                                                                 |
|                                                                       |
| "null",                                                               |
|                                                                       |
| "NULL",                                                               |
|                                                                       |
| "1",                                                                  |
|                                                                       |
| "",                                                                   |
|                                                                       |
| "true",                                                               |
|                                                                       |
| "false",                                                              |
|                                                                       |
| "1",                                                                  |
|                                                                       |
| "",                                                                   |
|                                                                       |
| "YES",                                                                |
|                                                                       |
| "NO",                                                                 |
|                                                                       |
| null,                                                                 |
|                                                                       |
| null,                                                                 |
|                                                                       |
| null,                                                                 |
|                                                                       |
| "",                                                                   |
|                                                                       |
| null,                                                                 |
|                                                                       |
| "2021/11/17 16:04:28",                                                |
|                                                                       |
| "T_20211117160428242847",                                             |
|                                                                       |
| "システム管理者"                                                      |
|                                                                       |
| ]                                                                     |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "UPLOAD_FILE": []                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

複数の同一ファイル名がアップロード対象ファイルの指定例
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Yaml形式で出力された収集対象ファイルについて、同一ホストで、階層別で同一ファイル名を取り扱う必要がある場合に、アップロード対象ファイルの指定例について記載します。

+-----------------------------------------------------------------------+
| e.g.)　収集対象ファイルのファイルパス、ディレクトリ構造               |
|                                                                       |
| 【上位ディレクトリ】                                                  |
|                                                                       |
| \|- \_parameters 　                                                   |
|                                                                       |
| \| \|- localhost 　                                                   |
|                                                                       |
| \| \|- SAMPLE.yml 　                                                  |
|                                                                       |
| \|- \_parameters_file                                                 |
|                                                                       |
| \| \|- localhost 　                                                   |
|                                                                       |
| 　　　　|- APP001                                                     |
|                                                                       |
| 　　　　|- config #①                                                  |
|                                                                       |
| 　　　　|- APP002                                                     |
|                                                                       |
| 　　　　|- config #②                                                  |
|                                                                       |
| 　　　　|- APP003                                                     |
|                                                                       |
| 　　　　|- config #③                                                  |
|                                                                       |
| 　　　　 \|- APP002                                                   |
|                                                                       |
| 　　　　 \|- config #④                                                |
|                                                                       |
| ■収集対象ファイル名：SAMPLE.yml                                       |
|                                                                       |
| ■ファイルの内容                                                       |
|                                                                       |
| VAR_upload_file_1: config                                             |
|                                                                       |
| VAR_upload_file_2: ‘/<上位ディレクトリ>/_parameters_file /localhost   |
| /APP002/config’                                                       |
|                                                                       |
| VAR_upload_file_3: ‘/APP002/config’                                   |
|                                                                       |
| VAR_upload_file_4: ‘/APP001/config’                                   |
|                                                                       |
| VAR_upload_file_5: ‘/APP003/APP002/config’                            |
+=======================================================================+
+-----------------------------------------------------------------------+

※上位ディレクトリについては、「
2.1収集対象ディレクトリ、ファイル構造」をご参照ください。

収集対象ファイルの内容収集時に対処となるファイルの実体は以下となります。

表 7-3　収集対象ファイルとファイルの実体

+------------------+---------------------------------------+-----------+
| **収集項目       | **対象ファイル**                      | **備考**  |
| (FROM)/変数名**  |                                       |           |
+==================+=======================================+===========+
| V                | 、①、②、③、④のファイルからランダム    |           |
| AR_upload_file_1 |                                       |           |
+------------------+---------------------------------------+-----------+
| V                | 、②のファイルが対象                   |           |
| AR_upload_file_2 |                                       |           |
+------------------+---------------------------------------+-----------+
| V                | 、②、④のファイルからランダム          |           |
| AR_upload_file_3 |                                       |           |
+------------------+---------------------------------------+-----------+
| V                | 、①のファイルが対象                   |           |
| AR_upload_file_4 |                                       |           |
+------------------+---------------------------------------+-----------+
| V                | 、④のファイルが対象                   |           |
| AR_upload_file_5 |                                       |           |
+------------------+---------------------------------------+-----------+

ファイル削除時の収集対象ファイル内の記載例
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ファイルアップロード項目のファイル削除する場合の収集対象ファイルの指定例について記載します。

削除するファイルについて対象の変数名の値を空文字として設定することで削除可能です。

+-----------------------------------------------------------------------+
| e.g.)　                                                               |
| ファイルア                                                            |
| ップロード項目の削除収集対象ファイルのファイルパス、ディレクトリ構造  |
|                                                                       |
| ■構造                                                                 |
|                                                                       |
| 【上位ディレクトリ】                                                  |
|                                                                       |
| \|- \_parameters                                                      |
|                                                                       |
| \| \|- localhost                                                      |
|                                                                       |
| \| \|- SAMPLE.yml ※ソースファイル                                     |
|                                                                       |
| \|- \_parameters_file                                                 |
|                                                                       |
| \| \|- localhost                                                      |
|                                                                       |
| ■収集対象ファイル名：SAMPLE.yml                                       |
|                                                                       |
| ■ファイルの内容                                                       |
|                                                                       |
| VAR_upload_file: "" ※アップロード対象ファイル                         |
+=======================================================================+
+-----------------------------------------------------------------------+

.. |image1| image:: ./media/image4.emf
   :width: 6.23056in
   :height: 0.18631in
.. |image2| image:: ./media/image5.png
   :width: 2.86735in
   :height: 0.93363in
.. |image3| image:: ./media/image6.png
   :width: 3.18238in
   :height: 0.76779in
.. |image4| image:: ./media/image6.png
   :width: 3.18194in
   :height: 0.76736in
.. |image5| image:: ./media/image6.png
   :width: 3.18194in
   :height: 0.76736in
