==============
Zabbixアダプタ
==============

| Zabbix アダプタは、Zabbix サーバで提供されているアラート情報(`トリガー情報 <https://www.zabbix.com/documentation/current/en/manual/api/reference/trigger/object>`_)を能動的に取得するための仕組みです。
| ディシジョンテーブルに対して、複数の Zabbix サーバと連携することが可能です。

前提条件
========

* 監視アダプタの登録を行う際には、事前にディシジョンテーブルが登録されている必要があります。ディシジョンテーブルの登録方法に関しては、:doc:`../rule_definition/decision_table` を参照してください。
* Zabbixと連携するためには、接続先のZabbixサーバのURLが http[s]://zabbix.server.fqdn/**zabbix** となっている必要があり、サービスが */zabbix* ディレクトリで公開されている必要があります。
* Zabbix監視アダプタがインストール済みである必要があります。インストール方法については、:doc:`adapter_install` を参照してください。

新規登録
========

| 上メニューの :menuselection:`システム --> 監視アダプタ` から監視アダプタ画面を開きます。
| 画面上部にある、:guilabel:` 監視先の追加` ボタンを押下します。
| 「ZABBIX Adapter ver1」を選択します。

.. tip::
    | 監視アダプタを追加するために、監視アダプタに対する「更新可能」のアクセス権限が必要です。


.. figure:: /images/ja/monitoring_adapter/monitoring_adapter_08_v1.6.png
   :scale: 80%
   :align: center

   監視アダプタの選択

| Zabbix アダプタの設定項目を入力します。

.. figure:: /images/ja/monitoring_adapter/monitoring_adapter_09.png
   :scale: 35%
   :align: left

   Zabbixアダプタ(ver. 1)設定画面


.. table:: Zabbixアダプタ(ver. 1)設定項目

+----------------------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 設定項目                                | 説明                                                                                                                                                                           |
+============================+============+================================================================================================================================================================================+
| 名前                                    | 入力必須項目です。OASEで管理する監視アダプタの名前を設定してください。                                                                                                         |
+----------------------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| プロトコル                              | 接続先に合わせてプルダウンメニューから「http」および「https」を選択してください。                                                                                              |
+----------------------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ホスト/IP                               | 入力必須項目です。FQDNもしくはIPアドレスを入力して下さい。128文字以内で入力して下さい。                                                                                        |
+----------------------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ポート                                  | Zabbixサーバに接続可能なポート番号を指定します。                                                                                                                               |
+----------------------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ユーザ名                                | Zabbix ユーザを指定します。                                                                                                                                                    |
+----------------------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| パスワード                              | Zabbix ユーザのスワードを入力します。                                                                                                                                          |
+----------------------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ディシジョンテーブル名選択              | 連携するディシジョンテーブルをプルダウンメニューから選択します。                                                                                                               |
+---------------+-------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 突合情報      | 条件名                  | 選択したディシジョンテーブルの条件が表示されます。                                                                                                                             |
|               +-------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|               | Zabbix項目              | ディシジョンテーブルの条件に対して評価対象となる `Zabbix のトリガー項目 <https://www.zabbix.com/documentation/current/en/manual/api/reference/trigger/object>`_ を選択します。 |
+---------------+-------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. raw:: html

   <div style="clear:both;"></div>

| 各項目の入力が完了したら、:guilabel:` 保存` ボタンを押し設定を保存します。


設定変更
========

| 上メニューの :menuselection:`システム --> 監視アダプタ` から監視アダプタ画面を開き、 :menuselection:`ZABBIX Adapter ver1` タブを押下し、Zabbix アダプタの一覧を表示します。

.. figure:: /images/ja/monitoring_adapter/monitoring_adapter_10.png
   :scale: 60%
   :align: center

   Zabbix アダプタ一覧

| 編集対象の監視アダプタの詳細確認ボタン :guilabel:`` をクリックし、詳細画面を開きます。

.. figure:: /images/ja/monitoring_adapter/monitoring_adapter_11.png
   :scale: 60%
   :align: center

   Zabbix アダプタ詳細画面

| 画面下部にある :guilabel:` 編集` ボタンから編集画面を開き、該当の項目を編集します。

.. figure:: /images/ja/monitoring_adapter/monitoring_adapter_13.png
   :scale: 60%
   :align: center

   Zabbix アダプタ編集画面

| 各項目の入力が完了したら、:guilabel:` 保存` ボタンを押し設定を保存します。