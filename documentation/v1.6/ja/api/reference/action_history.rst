==============
アクション履歴
==============

| アクション履歴の取得のために必要な情報について説明します。


プロパティ
==========

| API リクエスト時に指定するプロパティは下記のとおりです。

.. table:: イベントリクエストのプロパティ

   +---------------+----------+----------------------------+------------------------------------------------+
   | プロパティ    | データ型 | 説明/設定値                |  設定値説明                                    |
   +===============+==========+============================+================================================+
   | traceid       | 文字列   | 取得したいアクション履歴の イベントシリアルNo. を指定します。               |
   +---------------+----------+---------------+-------------------------------------------------------------+
 

リクエストヘッダ
================

| API リクエスト時に必要となるヘッダー情報は下記のとおりです。

.. table:: リクエストヘッダ

   +---------------+--------------------------------------+--------------------------------------+
   | ヘッダー      |説明/設定値                           | 設定値説明                           |
   +===============+======================================+======================================+
   | Content-Type  | コンテンツ形式                                                              |
   +               +--------------------------------------+--------------------------------------+
   |               | * application/json                   | JSON 形式のみサポートしています。    |
   +---------------+--------------------------------------+--------------------------------------+

レスポンス
==========

| API リクエスト時のレスポンスは下記の通りとなります。

+---------------------+----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
| プロパティ                                             | 説明/返却値                                                      | 返却値説明                                                                                       |
+=====================+==================================+==================================================================+==================================================================================================+
| result                                                 | API の実行結果です。                                                                                                                                                |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * true                                                           | API の実行に成功した場合に出力されます。                                                         |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * false                                                          | API の実行に失敗した場合に出力されます。                                                         |
+---------------------+----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
| msg                                                    | API の実行結果に対するメッセージです。                                                                                                                              |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * Successful completion.                                         | 正常終了                                                                                         |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * Successful completion. (Staging environment)                   | 正常終了（ステージング）                                                                         |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * Successful completion. (Production environment)                | 正常終了(プロダクション)                                                                         |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * Invalid trace ID                                               | 無効なイベントシリアルNo.です                                                                    |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * Invalid data.                                                  | 無効なデータです。                                                                               |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * Invalid request. Must be GET. Not POST.                        | 無効なリクエスト。 GETである必要があります。POSTではありません。                                 |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * Invalid request format. Must be JSON.                          | 無効なリクエスト形式。 JSON形式である必要があります。                                            |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * ActionType does not exists.                                    | 存在しないアクションタイプです。                                                                 |
+                                                        +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                                                        | * Unexpected error.                                              | 予想外のエラーです。                                                                             |
+---------------------+----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
| action_history_list                                    | リクエストしたイベントシリアルNo.に対するアクション履歴の情報が記述されます。                                                                                       |
+---------------------+----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     | status                           | ステータス                                                                                                                                                          |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 未処理                                                         |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 処理中(データを取得開始)                                       |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 処理済み(正常終了)                                             |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 強制処理済み                                                   | 何らかのエラーが発生し処理が終らない場合、「処理中」から「強制処理済み」に変更されます。         |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 異常終了(サーバーエラー)                                       | このエラーとなった場合はアクション履歴画面の「アクション再実行ボタン」からの再実行はできません。 |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 承認待ち                                                       |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 処理済み                                                       |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * Exastroリクエスト                                              |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 処理中(リトライ実行)                                           |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * アクション中断                                                 |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * アクション実行前エラー                                         |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * アクション実行エラー                                           |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 未実行                                                         |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 実行中                                                         |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 異常                                                           |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 取消                                                           |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 状態取得失敗                                                   |                                                                                                  |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * 抑止済                                                         |                                                                                                  |
+                     +----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     | rule_type_name                   | ディシジョンテーブル名が表示されます。                                                                                                                              |
+                     +----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     | rule_name                        | ディシジョンテーブルファイルで設定したルール名が表示されます。                                                                                                      |
+                     +----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     | action_type_id                   | アクション種別                                                                                                                                                      |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * ITA                                                            | 末尾にバージョン情報が表示されます。 例）ITA(ver1)                                               |
+                     +                                  +------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     |                                  | * メール                                                         | 末尾にバージョン情報が表示されます。 例）mail(ver1)                                              |
+                     +----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     | last_update_timestamp            | 最終実行日時が表示されます。                                                                                                                                        |
+                     +----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+
|                     | last_update_user                 | 最終実行者が表示されます。                                                                                                                                          |
+---------------------+----------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------------------------+

Example
=======

| ディシジョンテーブル *decisiontable001* に対して、リクエストを送信する例は以下のようになります。

リクエスト
----------

.. code-block:: sh

   curl -X GET -k 'https://<fqdn_or_ip_address>/oase_web/restapi/actionhistory/historyrequest' \
        -H 'accept: application/json' \
        -d '{
             ”traceid”: ”TOS_20210412053112220048_0000000010”
            }'

レスポンス
----------

.. code-block:: json

   {
     "result": true,
     "msg": "Successful completion.",
     "action_history_list": [
       {
         "status": "処理済み(正常終了)",
         "rule_type_name": "ルール種別001",
         "rule_name": "rule01",
         "action_type_id": "ITA(ver1)",
         "last_update_timestamp": "2018/11/20 14:31",
         "last_update_user": "アクションドライバープロシージャ"
       }
     ]
   }

